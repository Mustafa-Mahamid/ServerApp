<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>YouTube Favorites</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="m-0">YouTube Videos</h2>
    <div class="d-flex gap-2">
      <a class="btn btn-outline-secondary btn-sm" href="/">Home</a>
      <form method="POST" action="/logout" class="m-0">
        <button class="btn btn-danger btn-sm">Logout</button>
      </form>
    </div>
  </div>

  <div class="card mb-4">
    <div class="card-body">
      <form class="row g-2" action="/youtube/search" method="GET">
        <div class="col-md-10">
          <input class="form-control" name="q" placeholder="Search YouTube..." value="<%= q %>">
        </div>
        <div class="col-md-2 d-grid">
          <button class="btn btn-primary">Search</button>
        </div>
      </form>
    </div>
  </div>

  <h4>Results</h4>
  <div class="row g-3 mb-4">
    <% if (!results || results.length === 0) { %>
      <div class="col-12 text-muted">No results.</div>
    <% } %>

    <% results.forEach(v => { %>
      <div class="col-md-4">
        <div class="card h-100">
          <% if (v.thumbnail) { %>
            <img src="<%= v.thumbnail %>" class="card-img-top" alt="thumb">
          <% } %>
          <div class="card-body">
            <h6><%= v.title %></h6>
            <div class="text-muted small mb-2"><%= v.channel %></div>

            <a class="btn btn-outline-primary btn-sm" target="_blank"
               href="https://www.youtube.com/watch?v=<%= v.video_id %>">
              Watch
            </a>

            <form method="POST" action="/youtube/save" class="d-inline">
              <input type="hidden" name="video_id" value="<%= v.video_id %>">
              <input type="hidden" name="title" value="<%= v.title %>">
              <input type="hidden" name="channel" value="<%= v.channel %>">
              <input type="hidden" name="thumbnail" value="<%= v.thumbnail %>">
              <button class="btn btn-success btn-sm">Save</button>
            </form>
          </div>
        </div>
      </div>
    <% }) %>
  </div>

  <hr>

  <h4>My Favorites</h4>
  <div class="row g-3">
    <% if (!favorites || favorites.length === 0) { %>
      <div class="col-12 text-muted">No favorites yet.</div>
    <% } %>

    <% favorites.forEach(f => { %>
      <div class="col-md-4">
        <div class="card h-100">
          <% if (f.thumbnail) { %>
            <img src="<%= f.thumbnail %>" class="card-img-top" alt="thumb">
          <% } %>
          <div class="card-body">
            <h6><%= f.title %></h6>
            <div class="text-muted small mb-2"><%= f.channel %></div>

            <a class="btn btn-outline-primary btn-sm" target="_blank"
               href="https://www.youtube.com/watch?v=<%= f.video_id %>">
              Watch
            </a>

            <form method="POST" action="/youtube/delete" class="d-inline">
              <input type="hidden" name="id" value="<%= f.id %>">
              <button class="btn btn-outline-danger btn-sm">Delete</button>
            </form>
          </div>
        </div>
      </div>
    <% }) %>
  </div>

</div>
</body>
</html>